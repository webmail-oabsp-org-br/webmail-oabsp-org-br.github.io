var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,g){b instanceof String&&(b=String(b));for(var h=b.length,k=0;k<h;k++){var l=b[k];if(e.call(g,l,k,b))return{i:k,v:l}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,g){b!=Array.prototype&&b!=Object.prototype&&(b[e]=g.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,e,g,h){if(e){g=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var k=b[h];k in g||(g[k]={});g=g[k]}b=b[b.length-1];h=g[b];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6","es3");
$(document).ready(function(){window.rcmail&&rcmail.addEventListener("init",function(b){function g(a,d){rcmail.message_list.select_first_disable=!0;var b=rcmail.env.trash_mailbox,c=rcmail.selection_post_data();"undefined"!==typeof d&&(c._mbox=d);c._uid=a;d=function(a){rcmail.http_post(a,c,rcmail.display_message(rcmail.get_label("deletingmessage"),"loading"))};if(rcmail.env.flag_for_deletion)return rcmail.mark_message("delete",a),!1;b&&c._mbox!==b?rcmail.env.delete_junk&&rcmail.env.junk_mailbox&&c._mbox===
rcmail.env.junk_mailbox?d("delete",c):(c._target_mbox=b,d("move",c)):d("delete",c);rcmail.message_list.remove_row(a,rcmail.message_list.in_selection(a));if(rcmail.message_list.in_selection(a)&&rcmail.message_list.find_root(a)===a&&rcmail.message_list.row_children(a).length)return rcmail.command("checkmail","",{},{});rcmail.message_list.focus()}"function"===typeof addButtonOnToolbarMenu&&(addButtonOnToolbarMenu("buttonSkymailUserInfo",rcmail.gettext("userinfo","skymail_userinfo"),"settings/plugin.userinfo"),
addButtonOnToolbarMenu("buttonPasswordChange",rcmail.gettext("changepassword","skymail_custom"),"settings/plugin.password"),addButtonOnToolbarMenu("buttonVacationMessage",rcmail.gettext("vacationmessage","skymail_custom"),"settings/plugin.managesieve-vacation"),rcmail.env.responsive_skin_enabled&&addButtonOnToolbarMenu("buttonChangeWebmailFrontend",rcmail.gettext("try_new_webmail","skymail_custom"),"settings/plugin.change_webmail_version","change-webmail"));"undefined"!==typeof rcmail.env.framed&&
!1!==rcmail.env.framed||"undefined"===typeof rcmail.env.try_new_webmail||!1===rcmail.env.try_new_webmail||(1===rcmail.env.try_new_webmail?($('<div class="try-new-webmail"/>').html('<img src=plugins/skymail_custom/images/novo-webmail-responsivo.png width=560 height=377 /><div style="margin-top: 10px; font-size: 20px; line-height: 25px;">Interface mais moderna e intuitiva.</div><div style="margin-top: 20px; font-size: 15px; line-height: 25px;">'+rcmail.gettext("try_text_1","skymail_custom")+'</div><div style="font-size: 15px; line-height: 25px;"><a href="'+
rcmail.url("settings/plugin.change_webmail_version")+'" style="font-weight: bolder; text-decoration: none;">'+rcmail.gettext("click_here","skymail_custom")+"</a>"+rcmail.gettext("try_text_click","skymail_custom")+"</div>").appendTo("body").dialog({width:580,modal:!0,title:"Novidade"}),$(".try-new-webmail").closest(".ui-dialog").find(".ui-dialog-title").attr("style","color: white; background: #1d71b8; border-radius: 5px; font-weight: bolder; text-shadow: inherit !important; display: inline; width: auto !important; padding: 5px 20px !important;")):
$.toast({heading:rcmail.gettext("try_new_webmail","skymail_custom"),text:rcmail.gettext("try_text_1","skymail_custom")+' <br /> <a href="'+rcmail.url("settings/plugin.change_webmail_version")+'" style="font-weight: bolder; text-decoration: none; color: white;">'+rcmail.gettext("click_here","skymail_custom")+"</a>."+rcmail.gettext("try_text_click","skymail_custom"),icon:"info",showHideTransition:"slide",hideAfter:!1,bgColor:"#1e71b8"}));$(".localization").each(function(){var a=$(this);a.data("buttonText")?
a.append('<span class="button-text">'+rcmail.gettext(a.data("buttonText"),a.data("plugin"))+"</span>"):a.text(rcmail.gettext(a.data("name"),a.data("plugin")))});"settings"===rcmail.env.task&&"plugin.managesieve-vacation"===rcmail.env.action&&(b=$("#vacationform").find('input:not([value=""],[type="hidden"],[type="search"],[type="checkbox"],[type="button"])'),b.length&&(create=!0,b.each(function(){$(this).val()&&(create=!1)})),b.length&&!create||rcmail.managesieve_vacation_addresses());"settings"===
rcmail.env.task&&"plugin.managesieve"===rcmail.env.action&&function(){var a=$("#filterslistbox"),d=$('<input name="_q" id="quicksearchbox" type="text"/>'),b=$('<a id="searchreset" class="iconbutton reset" title="Limpar pesquisa" role="button" href="#" tabindex="0" aria-disabled="false"/>'),c=$('<div id="quicksearchbar" class="searchbox"/>');d.on("keyup",function(){var a=$("#filterslist tr");2<=d.val().length?a.each(function(){var a=$(this);a.find("td:not(:contains("+d.val()+"))").hide();a.find("td:contains("+
d.val()+")").show()}):a.find("td").show()});b.click(function(){$("#filterslist tr td").show();d.val("")});c.append(d).append(b);a.find(".boxtitle").after(c)}();if("mail"===rcmail.env.task){(function(){var a=rcmail.env.search_mods,d=[];$('input:checkbox[name="s_mods[]"]').map(function(){d.push(this.value)});for(var b in a){var c=a[b];for(var f in c)-1===d.indexOf(f)&&delete rcmail.env.search_mods[b][f];$.isEmptyObject(rcmail.env.search_mods[b])&&(rcmail.env.search_mods[b].text=1)}})();rcmail.addEventListener("insertrow",
function(a){if("widescreen"===rcmail.env.layout&&"undefined"!==typeof a.row){var d=a.row,b=$("<span/>").attr("title",rcmail.get_label("deletemessage")).attr("class","cmd-message-delete");b.get(0).onclick=function(){g(d.uid,d.mbox)};$("td.subject",a.row.obj).prepend(b)}});rcmail.show_headers=function(a,d){$("<div>").attr("id","content-allheader").appendTo(document.body);this.http_post("headers",{_uid:this.env.uid,_mbox:this.env.mailbox},this.display_message(this.get_label("loading"),"loading"))};rcmail.hide_headers=
function(a,d){return null};rcmail.set_headers=function(a){var d=$("#content-allheader").html(a);d.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:rcmail.gettext("messageheader","skymail_custom"),close:function(){d.dialog("destroy").remove()},width:640,height:400}).width(588).css("margin","0 0 13px 13px")};if("compose"===rcmail.env.action){var h=$("ul.attachmentslist"),k=h.find("li:first-child"),e=function(){var a=$("#compose-attachments"),d=$("#composebodycontainer"),b=h.outerHeight(),c=k.outerHeight()?
k.outerHeight()+3.5:38;b=Math.ceil(b/c)*c;var f=3*c;b<c&&(b=c);b>f&&(b=f+c/6);a.css("height",b+"px");d.css("top",b+1+"px");window.resize()};h.click(function(a){("A"===a.target.tagName||$(a.target).hasClass("delete"))&&window.setTimeout(function(){e()},500)});window.onresize=function(){e()};rcmail.addEventListener("fileuploaded",function(){window.setTimeout(function(){e()},800)});e()}"mail"!==rcmail.env.task||rcmail.env.action||(rcmail.skymail_custom={init:function(){this.folder.init();this.selectfirst.init();
rcmail.addEventListener("contextmenu_init",this.contextMenu.init)},selectfirst:{init:function(){var a=$("#mailpreviewframe");visible=a.is(":visible");a.get(0)&&visible&&(rcmail.env.contentframe="messagecontframe",(uid=rcmail.message_list.get_single_selection())&&rcmail.show_message(uid,!1,!0));visible&&uid&&rcmail.message_list&&rcmail.message_list.scrollto(uid);"mail"===rcmail.env.task&&(rcmail.addEventListener("beforedelete",function(){rcmail.message_list.selectfirst_disable=!0}),rcmail.addEventListener("delete",
function(){rcmail.message_list.selectfirst_disable=!0}),"list"!==rcmail.env.action&&rcmail.env.action||rcmail.addEventListener("init",function(){rcmail.addEventListener("listupdate",function(a){if("undefined"!==typeof a.folder&&!rcmail.message_list.selectfirst_disable){if("undefined"!==typeof rcmail.env.selectfirst&&"noselect"===rcmail.env.selectfirst)return;rcmail.message_list.get_single_selection()||rcmail.message_list.select_first(rcube_event.get_modifier(a))}rcmail.message_list.selectfirst_disable=
!1})}))}},contextMenu:{init:function(a){"folderlist"===a.menu_name&&(a.menu_source.push({label:"Nova pasta",command:"plugin.skymail_custom.createfolder",props:"",classes:"createfolder"}),a.menu_source.push({label:"Renomear",command:"plugin.skymail_custom.renamefolder",props:"",classes:"renamefolder"}),a.menu_source.push({label:"Excluir",command:"plugin.skymail_custom.deletefolder",props:"",classes:"deletefolder"}),a.addEventListener("activate",function(a){a=$(a.el).closest("ul").find("a.renamefolder, a.deletefolder");
a.show();-1!==$.inArray(rcmail.env.context_menu_source_id,[rcmail.env.trash_mailbox,rcmail.env.sent_mbox,rcmail.env.junk_mailbox,rcmail.env.drafts_mailbox,"INBOX"])&&a.hide()}))}},folder:{sessionName:"folder_message",getEl:function(a){var b=$("#rcmli"+$.base64.encode(rcmail.env.context_menu_source_id).replace(/=+/,""));a&&(b=$("#mailboxlist").find("li.mailbox.trash"));return b},init:function(){sessionStorage.getItem(rcmail.skymail_custom.folder.sessionName)&&(eval(sessionStorage.getItem(rcmail.skymail_custom.folder.sessionName)),
sessionStorage.removeItem(rcmail.skymail_custom.folder.sessionName));rcmail.register_command("plugin.skymail_custom.createfolder",this.create.init);rcmail.register_command("plugin.skymail_custom.deletefolder",this.remove.init);rcmail.register_command("plugin.skymail_custom.renamefolder",this.rename.init)},input:{create:function(a,b,e){this.remove();var d=function(a){var b=$.trim(a.val()),d=!1;a.closest("ul").children("li").each(function(){var a=$.trim($(this).find("a").attr("rel")),c=a.match(/(^.*\.)?\.?.*/);
"undefined"!==typeof c[1]&&(a=a.replace(c[1],""));a===b&&(d=!0)});return d?(rcmail.display_message("Nome j\u00e1 existente","warning",2E3),!1):!0},f=$('<input class="addfolder" type="text" />').val(e).on({keyup:function(c){f.val(f.val().replace(/[\/\./,;]*/g,""));switch(c.keyCode){case 13:d(f)&&"function"===typeof a&&a();break;case 27:"function"===typeof b&&b(),rcmail.skymail_custom.folder.input.remove()}},blur:function(){"function"===typeof b&&b();if("function"===typeof a&&""!==$(this).val().trim()&&
confirm(rcmail.gettext("confirm_folder_on_blur","skymail_custom")+$(this).val()+"?")){if(!d($(this)))return!1;a();return!0}rcmail.skymail_custom.folder.input.remove()}});return f},get:function(){return $("#mailboxlist li.input input")},remove:function(){$("#mailboxlist li.input").remove()}},rename:{init:function(){var a=rcmail.skymail_custom.folder,b=a.getEl().find("a").first(),e=$('<li class="input"/>'),c=$.trim(b.clone().children().remove().end().text()),f=c.match(/(^.*\.)?\.?.*/);b.hide();"undefined"!==
typeof f[1]&&(c=c.replace(f[1],""));c=a.input.create(function(){var b=rcmail.skymail_custom.folder.getEl().find("a").attr("rel"),d=rcmail.env.context_menu_source_id,c=-1!==d.indexOf(".")?d.split(".").slice(-1).pop():d,e=-1!==b.indexOf(".")?".":"";b=b.replace(e+c,"");rcmail.http_post("save-folder",{_mbox:d,_name:a.input.get().val(),_token:rcmail.env.request_token,_task:"settings",_parent:b},rcmail.set_busy(!0,"loading"));rcmail.addEventListener("responsebefore",function(a){"save-folder"==a.response.action&&
"mail"==rcmail.env.task&&(a.response.renamed_folder=!0,rcmail.skymail_custom.folder.callback(a))})},function(){b.show()},$.trim(c));e.append(c).insertAfter(b);c.focus()}},create:{init:function(a){var b=rcmail.skymail_custom.folder,e=b.getEl(a),c=e.children("ul");c.length||(c=$("<ul />"),e.append(c));a&&(c=e.closest("ul"),e.find("a").attr("rel",""));var f=b.input.create(function(){rcmail.http_post("save-folder",{_name:b.input.get().val(),_token:rcmail.env.request_token,_task:"settings",_parent:e.find("a").attr("rel")},
rcmail.set_busy(!0,"loading"));rcmail.addEventListener("responseafter",function(a){"save-folder"==a.response.action&&"mail"==rcmail.env.task&&rcmail.skymail_custom.folder.callback(a)})});a?$('<li class="input" />').append(f).insertAfter(e):c.prepend($('<li class="input" />').append(f));c.find("input.addfolder").focus()}},remove:{init:function(){var a=$.trim($(rcmail.env.contextmenus.folderlist.selected_object).find("a").clone().children().remove().end().text()),b=a.match(/(^.*\.)?\.?.*/);"undefined"!==
typeof b[1]&&(a=a.replace(b[1],""));confirm("Tem certeza que deseja excluir a pasta "+a+"?")&&rcmail.http_post("plugin.skymail_custom.deletefolder",{_mbox:rcmail.env.context_menu_source_id})},callback:function(){location.href="/?_task=mail&_mbox=INBOX"}},callback:function(a){var b=a.response.exec,e=b.toString().match(/(this\.display_message[^;]+)/g).join(";").replace("this","rcmail").replace(",0)",", 5000);"),c="undefined"===typeof rcmail.env.search_request?rcmail.message_list.get_single_selection():
null,f=location.href,g=rcmail.skymail_custom.folder.input.get().val();b=b.match(/(this\.[a-z]+_folder_row\("([^"]+))/)[2];if(a.response.renamed_folder){a=rcmail.env.context_menu_source_id;var h=rcmail.env.mailbox;if(-1!==h.indexOf(a)||a===h)mboxRenamed=-1!==a.indexOf(".")?a.split(".").slice(-1).pop():a,newActualFolder=h.replace(mboxRenamed,g),f=location.origin+"/?_task=mail&_mbox="+encodeURIComponent(newActualFolder)}location.href=f+(c?"&_uid="+c:"");sessionStorage.setItem(rcmail.skymail_custom.folder.sessionName,
e+("rcmail.skymail_custom.folder.blinkAndFocusFolder('"+b+"');"))},blinkAndFocusFolder:function(a){var b=$("[rel='"+a+"']");a=$("#folderlist-content");b.length&&(scroller=b.offset().top-a.offset().top,0<scroller&&a.animate({scrollTop:scroller},2E3),oldBg=b.css("background-color"),b.css("background-color","#fff192"),setTimeout(function(){b.css("background-color",oldBg)},2E3))}}},rcmail.skymail_custom.init());"show"!==rcmail.env.action&&"preview"!==rcmail.env.action||!rcmail.env.framed&&!rcmail.env.extwin||
(rcmail.skymail_mailview={init:function(){var a=rcmail.env.framed?window.parent:window.opener;rcmail.env.mailboxes_list=a.rcmail.env.mailboxes_list;rcmail.env.mailboxes=a.rcmail.env.mailboxes;rcmail.labels.copyingmessage=a.rcmail.labels.copyingmessage;rcmail.labels.movingmessage=a.rcmail.labels.movingmessage;rcmail.addEventListener("responseaftermove",function(){if(rcmail.env.framed){var a=window.parent.rcmail.message_list;a.remove_row(a.last_selected,!0)}})}},rcmail.skymail_mailview.init())}});if("identities"===
rcmail.env.action&&"settings"===rcmail.env.task&&!0===rcmail.env.disableeditidentities){$("#identitieslist").find(".listbutton").remove();var b=rcmail.gettext("identity","skymail_custom");b=b.charAt(0).toUpperCase()+b.slice(1);$("#preferences-frame").contents().find(".boxtitle").text(b);removeEditIdentities=function(){$("#preferences-frame").contents().find(".footerleft").remove();clearInterval(interval)};interval=window.setInterval(removeEditIdentities,400)}"mail"===rcmail.env.task&&"compose"===
rcmail.env.action&&!0===rcmail.env.disableeditidentities&&(removeEditComposeIdentities=function(){$(".lineidentity").find("a").remove();clearInterval(interval)},interval=window.setInterval(removeEditComposeIdentities,400));$(".send").on("click",function(){stillworking=0;setInterval(function(){$(".loading").length&&(stillworking=rcmail.display_message(rcmail.gettext("stillworking","skymail_custom"),"notice",3E3));clearTimeout(stillworking)},8E3)})});
